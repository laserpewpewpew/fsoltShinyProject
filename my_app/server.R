library(shiny)
library(foreign)
library(car)
library(ggplot2)

swiid <- read.csv("SWIIDv5_0summary.csv", as.is=T)

shinyServer(function(input, output) {
  
  output$plot <- renderPlot({
    
    country1 <- switch(input$country1,
                       "Not Selected" = "Not Selected",
                       "Albania" = "Albania",
                       "Algeria" = "Algeria",
                       "Andorra" = "Andorra",
                       "Angola" = "Angola",
                       "Anguilla" = "Anguilla",
                       "Argentina" = "Argentina",
                       "Armenia" = "Armenia",
                       "Australia" = "Australia",
                       "Austria" = "Austria",
                       "Azerbaijan" = "Azerbaijan",
                       "Bahamas" = "Bahamas",
                       "Bangladesh" = "Bangladesh",
                       "Barbados" = "Barbados",
                       "Belarus" = "Belarus",
                       "Belgium" = "Belgium",
                       "Belize" = "Belize",
                       "Benin" = "Benin",
                       "Bhutan" = "Bhutan",
                       "Boliva" = "Boliva",
                       "Bosnia and Herzegovina" = "Bosnia and Herzegovina",
                       "Botswana" = "Botswana",
                       "Brazil" = "Brazil",
                       "Bulgaria" = "Bulgaria",
                       "Burkina Faso" = "Burkina Faso",
                       "Burundi" = "Burundi",
                       "Cambodia" = "Cambodia",
                       "Cameroon" = "Cameroon",
                       "Canada" = "Canada",
                       "Cape Verde" = "Cape Verde",
                       "Central African Republic" = "Central African Republic",
                       "Chad" = "Chad",
                       "Chile" = "Chile",
                       "China" = "China",
                       "Colombia" = "Colombia",
                       "Comoros" = "Comoros",
                       "Congo, Democratic Republic of" = "Congo, Democratic Republic of",
                       "Congo, Republic of" = "Congo, Republic of",
                       "Costa Rica" = "Costa Rica",
                       "Cote d'Ivoire" = "Cote d'Ivoire",
                       "Croatia" = "Croatia",
                       "Cuba" = "Cuba",
                       "Cyprus" = "Cyprus",
                       "Czech Republic" = "Czech Republic",
                       "Czechoslovakia" = "Czechoslovakia",
                       "Denmark" = "Denmark",
                       "Djibouti" = "Djibouti",
                       "Dominica" = "Dominica",
                       "Dominican Republic" = "Dominican Republic",
                       "Ecuador" = "Ecuador",
                       "Egypt" = "Egypt",
                       "El Salvador" = "El Salvador",
                       "Estonia" = "Estonia",
                       "Ethiopia" = "Ethiopia",
                       "Fiji" = "Fiji",
                       "Finland" = "Finland",
                       "France" = "France",
                       "Gabon" = "Gabon",
                       "Gambia" = "Gambia",
                       "Georgia" = "Georgia",
                       "Germany" = "Germany",
                       "Ghana" = "Ghana",
                       "Greece" = "Greece",
                       "Grenada" = "Grenada",
                       "Guatemala" = "Guatemala",
                       "Guinea" = "Guinea",
                       "Guinea-Bissau" = "Guinea-Bissau",
                       "Guyana" = "Guyana",
                       "Haiti" = "Haiti",
                       "Honduras" = "Honduras",
                       "Hong Kong" = "Hong Kong",
                       "Hungary" = "Hungary",
                       "Iceland" = "Iceland",
                       "India" = "India",
                       "Indonesia" = "Indonesia",
                       "Iran" = "Iran",
                       "Iraq" = "Iraq",
                       "Ireland" = "Ireland",
                       "Israel" = "Israel",
                       "Italy" = "Italy",
                       "Jamaica" = "Jamaica",
                       "Japan" = "Japan",
                       "Jordan" = "Jordan",
                       "Kazakhstan" = "Kazakhstan",
                       "Kenya" = "Kenya",
                       "Korea, Republic of" = "Korea, Republic of",
                       "Kyrgyz Republic" = "Kyrgyz Republic",
                       "Lao" = "Lao",
                       "Latvia" = "Latvia",
                       "Lebanon" = "Lebanon",
                       "Lesotho" = "Lesotho",
                       "Liberia" = "Liberia",
                       "Lithuania" = "Lithuania",
                       "Luxembourg" = "Luxembourg",
                       "Macedonia, FYR" = "Macedonia, FYR",
                       "Madagascar" = "Madagascar",
                       "Malawi" = "Malawi",
                       "Malaysia" = "Malaysia",
                       "Maldives" = "Maldives",
                       "Mali" = "Mali",
                       "Malta" = "Malta",
                       "Mauritania" = "Mauritania",
                       "Mauritius" = "Mauritius",
                       "Mexico" = "Mexico",
                       "Moldova" = "Moldova",
                       "Mongolia" = "Mongolia",
                       "Montenegro" = "Montenegro",
                       "Morocco" = "Morocco",
                       "Mozambique" = "Mozambique",
                       "Namibia" = "Namibia",
                       "Nepal" = "Nepal",
                       "Netherlands" = "Netherlands",
                       "New Zealand" = "New Zealand",
                       "Nicaragua" = "Nicaragua",
                       "Niger" = "Niger",
                       "Nigeria" = "Nigeria",
                       "Norway" = "Norway",
                       "Pakistan" = "Pakistan",
                       "Panama" = "Panama",
                       "Papua New Guinea" = "Papua New Guinea",
                       "Paraguay" = "Paraguay",
                       "Peru" = "Peru",
                       "Philippines" = "Philippines",
                       "Poland" = "Poland",
                       "Portugal" = "Portugal",
                       "Puerto Rico" = "Puerto Rico",
                       "Reunion" = "Reunion",
                       "Romania" = "Romania",
                       "Russian Federation" = "Russian Federation",
                       "Rwanda" = "Rwanda",
                       "Sao Tome and Principe" = "Sao Tome and Principe",
                       "Senegal" = "Senegal",
                       "Serbia" = "Serbia",
                       "Serbia and Montenegro" = "Serbia and Montenegro",
                       "Seychelles" = "Seychelles",
                       "Sierra Leone" = "Sierra Leone",
                       "Singapore" = "Singapore",
                       "Slovak Republic" = "Slovak Republic",
                       "Slovenia" = "Slovenia",
                       "Somalia" = "Somalia",
                       "South Africa" = "South Africa",
                       "Spain" = "Spain",
                       "Sri Lanka" = "Sri Lanka",
                       "St. Lucia" = "St. Lucia",
                       "St. Vincent and the Grenadines" = "St. Vincent and the Grenadines",
                       "Sudan" = "Sudan",
                       "Suriname" = "Suriname",
                       "Swaziland" = "Swaziland",
                       "Sweden" = "Sweden",
                       "Switzerland" = "Switzerland",
                       "Syria" = "Syria",
                       "Taiwan" = "Taiwan",
                       "Tajikistan" = "Tajikistan",
                       "Tanzania" = "Tanzania",
                       "Thailand" = "Thailand",
                       "Timor-Leste" = "Timor-Leste",
                       "Togo" = "Togo",
                       "Trinidad and Tobago" = "Trinidad and Tobago",
                       "Tunisia" = "Tunisia",
                       "Turkey" = "Turkey",
                       "Turkmenistan" = "Turkmenistan",
                       "Turks and Caicos" = "Turks and Caicos",
                       "USSR" = "USSR",
                       "Uganda" = "Uganda",
                       "Ukraine" = "Ukraine",
                       "United Kingdom" = "United Kingdom",
                       "United States" = "United States",
                       "Uruguay" = "Uruguay",
                       "Uzbekistan" = "Uzbekistan",
                       "Venezuela" = "Venezuela",
                       "Viet Nam" = "Viet Nam",
                       "Yemen, Republic of" = "Yemen, Republic of",
                       "Yugoslavia" = "Yugoslavia",
                       "Zambia" = "Zambia",
                       "Zimbabwe" = "Zimbabwe")
            
    country2 <- switch(input$country2,
                       "Not Selected" = "Not Selected",
                       "Albania" = "Albania",
                       "Algeria" = "Algeria",
                       "Andorra" = "Andorra",
                       "Angola" = "Angola",
                       "Anguilla" = "Anguilla",
                       "Argentina" = "Argentina",
                       "Armenia" = "Armenia",
                       "Australia" = "Australia",
                       "Austria" = "Austria",
                       "Azerbaijan" = "Azerbaijan",
                       "Bahamas" = "Bahamas",
                       "Bangladesh" = "Bangladesh",
                       "Barbados" = "Barbados",
                       "Belarus" = "Belarus",
                       "Belgium" = "Belgium",
                       "Belize" = "Belize",
                       "Benin" = "Benin",
                       "Bhutan" = "Bhutan",
                       "Boliva" = "Boliva",
                       "Bosnia and Herzegovina" = "Bosnia and Herzegovina",
                       "Botswana" = "Botswana",
                       "Brazil" = "Brazil",
                       "Bulgaria" = "Bulgaria",
                       "Burkina Faso" = "Burkina Faso",
                       "Burundi" = "Burundi",
                       "Cambodia" = "Cambodia",
                       "Cameroon" = "Cameroon",
                       "Canada" = "Canada",
                       "Cape Verde" = "Cape Verde",
                       "Central African Republic" = "Central African Republic",
                       "Chad" = "Chad",
                       "Chile" = "Chile",
                       "China" = "China",
                       "Colombia" = "Colombia",
                       "Comoros" = "Comoros",
                       "Congo, Democratic Republic of" = "Congo, Democratic Republic of",
                       "Congo, Republic of" = "Congo, Republic of",
                       "Costa Rica" = "Costa Rica",
                       "Cote d'Ivoire" = "Cote d'Ivoire",
                       "Croatia" = "Croatia",
                       "Cuba" = "Cuba",
                       "Cyprus" = "Cyprus",
                       "Czech Republic" = "Czech Republic",
                       "Czechoslovakia" = "Czechoslovakia",
                       "Denmark" = "Denmark",
                       "Djibouti" = "Djibouti",
                       "Dominica" = "Dominica",
                       "Dominican Republic" = "Dominican Republic",
                       "Ecuador" = "Ecuador",
                       "Egypt" = "Egypt",
                       "El Salvador" = "El Salvador",
                       "Estonia" = "Estonia",
                       "Ethiopia" = "Ethiopia",
                       "Fiji" = "Fiji",
                       "Finland" = "Finland",
                       "France" = "France",
                       "Gabon" = "Gabon",
                       "Gambia" = "Gambia",
                       "Georgia" = "Georgia",
                       "Germany" = "Germany",
                       "Ghana" = "Ghana",
                       "Greece" = "Greece",
                       "Grenada" = "Grenada",
                       "Guatemala" = "Guatemala",
                       "Guinea" = "Guinea",
                       "Guinea-Bissau" = "Guinea-Bissau",
                       "Guyana" = "Guyana",
                       "Haiti" = "Haiti",
                       "Honduras" = "Honduras",
                       "Hong Kong" = "Hong Kong",
                       "Hungary" = "Hungary",
                       "Iceland" = "Iceland",
                       "India" = "India",
                       "Indonesia" = "Indonesia",
                       "Iran" = "Iran",
                       "Iraq" = "Iraq",
                       "Ireland" = "Ireland",
                       "Israel" = "Israel",
                       "Italy" = "Italy",
                       "Jamaica" = "Jamaica",
                       "Japan" = "Japan",
                       "Jordan" = "Jordan",
                       "Kazakhstan" = "Kazakhstan",
                       "Kenya" = "Kenya",
                       "Korea, Republic of" = "Korea, Republic of",
                       "Kyrgyz Republic" = "Kyrgyz Republic",
                       "Lao" = "Lao",
                       "Latvia" = "Latvia",
                       "Lebanon" = "Lebanon",
                       "Lesotho" = "Lesotho",
                       "Liberia" = "Liberia",
                       "Lithuania" = "Lithuania",
                       "Luxembourg" = "Luxembourg",
                       "Macedonia, FYR" = "Macedonia, FYR",
                       "Madagascar" = "Madagascar",
                       "Malawi" = "Malawi",
                       "Malaysia" = "Malaysia",
                       "Maldives" = "Maldives",
                       "Mali" = "Mali",
                       "Malta" = "Malta",
                       "Mauritania" = "Mauritania",
                       "Mauritius" = "Mauritius",
                       "Mexico" = "Mexico",
                       "Moldova" = "Moldova",
                       "Mongolia" = "Mongolia",
                       "Montenegro" = "Montenegro",
                       "Morocco" = "Morocco",
                       "Mozambique" = "Mozambique",
                       "Namibia" = "Namibia",
                       "Nepal" = "Nepal",
                       "Netherlands" = "Netherlands",
                       "New Zealand" = "New Zealand",
                       "Nicaragua" = "Nicaragua",
                       "Niger" = "Niger",
                       "Nigeria" = "Nigeria",
                       "Norway" = "Norway",
                       "Pakistan" = "Pakistan",
                       "Panama" = "Panama",
                       "Papua New Guinea" = "Papua New Guinea",
                       "Paraguay" = "Paraguay",
                       "Peru" = "Peru",
                       "Philippines" = "Philippines",
                       "Poland" = "Poland",
                       "Portugal" = "Portugal",
                       "Puerto Rico" = "Puerto Rico",
                       "Reunion" = "Reunion",
                       "Romania" = "Romania",
                       "Russian Federation" = "Russian Federation",
                       "Rwanda" = "Rwanda",
                       "Sao Tome and Principe" = "Sao Tome and Principe",
                       "Senegal" = "Senegal",
                       "Serbia" = "Serbia",
                       "Serbia and Montenegro" = "Serbia and Montenegro",
                       "Seychelles" = "Seychelles",
                       "Sierra Leone" = "Sierra Leone",
                       "Singapore" = "Singapore",
                       "Slovak Republic" = "Slovak Republic",
                       "Slovenia" = "Slovenia",
                       "Somalia" = "Somalia",
                       "South Africa" = "South Africa",
                       "Spain" = "Spain",
                       "Sri Lanka" = "Sri Lanka",
                       "St. Lucia" = "St. Lucia",
                       "St. Vincent and the Grenadines" = "St. Vincent and the Grenadines",
                       "Sudan" = "Sudan",
                       "Suriname" = "Suriname",
                       "Swaziland" = "Swaziland",
                       "Sweden" = "Sweden",
                       "Switzerland" = "Switzerland",
                       "Syria" = "Syria",
                       "Taiwan" = "Taiwan",
                       "Tajikistan" = "Tajikistan",
                       "Tanzania" = "Tanzania",
                       "Thailand" = "Thailand",
                       "Timor-Leste" = "Timor-Leste",
                       "Togo" = "Togo",
                       "Trinidad and Tobago" = "Trinidad and Tobago",
                       "Tunisia" = "Tunisia",
                       "Turkey" = "Turkey",
                       "Turkmenistan" = "Turkmenistan",
                       "Turks and Caicos" = "Turks and Caicos",
                       "USSR" = "USSR",
                       "Uganda" = "Uganda",
                       "Ukraine" = "Ukraine",
                       "United Kingdom" = "United Kingdom",
                       "United States" = "United States",
                       "Uruguay" = "Uruguay",
                       "Uzbekistan" = "Uzbekistan",
                       "Venezuela" = "Venezuela",
                       "Viet Nam" = "Viet Nam",
                       "Yemen, Republic of" = "Yemen, Republic of",
                       "Yugoslavia" = "Yugoslavia",
                       "Zambia" = "Zambia",
                       "Zimbabwe" = "Zimbabwe")
    
    country3 <- switch(input$country3,
                       "Not Selected" = "Not Selected",
                       "Albania" = "Albania",
                       "Algeria" = "Algeria",
                       "Andorra" = "Andorra",
                       "Angola" = "Angola",
                       "Anguilla" = "Anguilla",
                       "Argentina" = "Argentina",
                       "Armenia" = "Armenia",
                       "Australia" = "Australia",
                       "Austria" = "Austria",
                       "Azerbaijan" = "Azerbaijan",
                       "Bahamas" = "Bahamas",
                       "Bangladesh" = "Bangladesh",
                       "Barbados" = "Barbados",
                       "Belarus" = "Belarus",
                       "Belgium" = "Belgium",
                       "Belize" = "Belize",
                       "Benin" = "Benin",
                       "Bhutan" = "Bhutan",
                       "Boliva" = "Boliva",
                       "Bosnia and Herzegovina" = "Bosnia and Herzegovina",
                       "Botswana" = "Botswana",
                       "Brazil" = "Brazil",
                       "Bulgaria" = "Bulgaria",
                       "Burkina Faso" = "Burkina Faso",
                       "Burundi" = "Burundi",
                       "Cambodia" = "Cambodia",
                       "Cameroon" = "Cameroon",
                       "Canada" = "Canada",
                       "Cape Verde" = "Cape Verde",
                       "Central African Republic" = "Central African Republic",
                       "Chad" = "Chad",
                       "Chile" = "Chile",
                       "China" = "China",
                       "Colombia" = "Colombia",
                       "Comoros" = "Comoros",
                       "Congo, Democratic Republic of" = "Congo, Democratic Republic of",
                       "Congo, Republic of" = "Congo, Republic of",
                       "Costa Rica" = "Costa Rica",
                       "Cote d'Ivoire" = "Cote d'Ivoire",
                       "Croatia" = "Croatia",
                       "Cuba" = "Cuba",
                       "Cyprus" = "Cyprus",
                       "Czech Republic" = "Czech Republic",
                       "Czechoslovakia" = "Czechoslovakia",
                       "Denmark" = "Denmark",
                       "Djibouti" = "Djibouti",
                       "Dominica" = "Dominica",
                       "Dominican Republic" = "Dominican Republic",
                       "Ecuador" = "Ecuador",
                       "Egypt" = "Egypt",
                       "El Salvador" = "El Salvador",
                       "Estonia" = "Estonia",
                       "Ethiopia" = "Ethiopia",
                       "Fiji" = "Fiji",
                       "Finland" = "Finland",
                       "France" = "France",
                       "Gabon" = "Gabon",
                       "Gambia" = "Gambia",
                       "Georgia" = "Georgia",
                       "Germany" = "Germany",
                       "Ghana" = "Ghana",
                       "Greece" = "Greece",
                       "Grenada" = "Grenada",
                       "Guatemala" = "Guatemala",
                       "Guinea" = "Guinea",
                       "Guinea-Bissau" = "Guinea-Bissau",
                       "Guyana" = "Guyana",
                       "Haiti" = "Haiti",
                       "Honduras" = "Honduras",
                       "Hong Kong" = "Hong Kong",
                       "Hungary" = "Hungary",
                       "Iceland" = "Iceland",
                       "India" = "India",
                       "Indonesia" = "Indonesia",
                       "Iran" = "Iran",
                       "Iraq" = "Iraq",
                       "Ireland" = "Ireland",
                       "Israel" = "Israel",
                       "Italy" = "Italy",
                       "Jamaica" = "Jamaica",
                       "Japan" = "Japan",
                       "Jordan" = "Jordan",
                       "Kazakhstan" = "Kazakhstan",
                       "Kenya" = "Kenya",
                       "Korea, Republic of" = "Korea, Republic of",
                       "Kyrgyz Republic" = "Kyrgyz Republic",
                       "Lao" = "Lao",
                       "Latvia" = "Latvia",
                       "Lebanon" = "Lebanon",
                       "Lesotho" = "Lesotho",
                       "Liberia" = "Liberia",
                       "Lithuania" = "Lithuania",
                       "Luxembourg" = "Luxembourg",
                       "Macedonia, FYR" = "Macedonia, FYR",
                       "Madagascar" = "Madagascar",
                       "Malawi" = "Malawi",
                       "Malaysia" = "Malaysia",
                       "Maldives" = "Maldives",
                       "Mali" = "Mali",
                       "Malta" = "Malta",
                       "Mauritania" = "Mauritania",
                       "Mauritius" = "Mauritius",
                       "Mexico" = "Mexico",
                       "Moldova" = "Moldova",
                       "Mongolia" = "Mongolia",
                       "Montenegro" = "Montenegro",
                       "Morocco" = "Morocco",
                       "Mozambique" = "Mozambique",
                       "Namibia" = "Namibia",
                       "Nepal" = "Nepal",
                       "Netherlands" = "Netherlands",
                       "New Zealand" = "New Zealand",
                       "Nicaragua" = "Nicaragua",
                       "Niger" = "Niger",
                       "Nigeria" = "Nigeria",
                       "Norway" = "Norway",
                       "Pakistan" = "Pakistan",
                       "Panama" = "Panama",
                       "Papua New Guinea" = "Papua New Guinea",
                       "Paraguay" = "Paraguay",
                       "Peru" = "Peru",
                       "Philippines" = "Philippines",
                       "Poland" = "Poland",
                       "Portugal" = "Portugal",
                       "Puerto Rico" = "Puerto Rico",
                       "Reunion" = "Reunion",
                       "Romania" = "Romania",
                       "Russian Federation" = "Russian Federation",
                       "Rwanda" = "Rwanda",
                       "Sao Tome and Principe" = "Sao Tome and Principe",
                       "Senegal" = "Senegal",
                       "Serbia" = "Serbia",
                       "Serbia and Montenegro" = "Serbia and Montenegro",
                       "Seychelles" = "Seychelles",
                       "Sierra Leone" = "Sierra Leone",
                       "Singapore" = "Singapore",
                       "Slovak Republic" = "Slovak Republic",
                       "Slovenia" = "Slovenia",
                       "Somalia" = "Somalia",
                       "South Africa" = "South Africa",
                       "Spain" = "Spain",
                       "Sri Lanka" = "Sri Lanka",
                       "St. Lucia" = "St. Lucia",
                       "St. Vincent and the Grenadines" = "St. Vincent and the Grenadines",
                       "Sudan" = "Sudan",
                       "Suriname" = "Suriname",
                       "Swaziland" = "Swaziland",
                       "Sweden" = "Sweden",
                       "Switzerland" = "Switzerland",
                       "Syria" = "Syria",
                       "Taiwan" = "Taiwan",
                       "Tajikistan" = "Tajikistan",
                       "Tanzania" = "Tanzania",
                       "Thailand" = "Thailand",
                       "Timor-Leste" = "Timor-Leste",
                       "Togo" = "Togo",
                       "Trinidad and Tobago" = "Trinidad and Tobago",
                       "Tunisia" = "Tunisia",
                       "Turkey" = "Turkey",
                       "Turkmenistan" = "Turkmenistan",
                       "Turks and Caicos" = "Turks and Caicos",
                       "USSR" = "USSR",
                       "Uganda" = "Uganda",
                       "Ukraine" = "Ukraine",
                       "United Kingdom" = "United Kingdom",
                       "United States" = "United States",
                       "Uruguay" = "Uruguay",
                       "Uzbekistan" = "Uzbekistan",
                       "Venezuela" = "Venezuela",
                       "Viet Nam" = "Viet Nam",
                       "Yemen, Republic of" = "Yemen, Republic of",
                       "Yugoslavia" = "Yugoslavia",
                       "Zambia" = "Zambia",
                       "Zimbabwe" = "Zimbabwe")
    
    country4 <- switch(input$country4,
                       "Not Selected" = "Not Selected",
                       "Albania" = "Albania",
                       "Algeria" = "Algeria",
                       "Andorra" = "Andorra",
                       "Angola" = "Angola",
                       "Anguilla" = "Anguilla",
                       "Argentina" = "Argentina",
                       "Armenia" = "Armenia",
                       "Australia" = "Australia",
                       "Austria" = "Austria",
                       "Azerbaijan" = "Azerbaijan",
                       "Bahamas" = "Bahamas",
                       "Bangladesh" = "Bangladesh",
                       "Barbados" = "Barbados",
                       "Belarus" = "Belarus",
                       "Belgium" = "Belgium",
                       "Belize" = "Belize",
                       "Benin" = "Benin",
                       "Bhutan" = "Bhutan",
                       "Boliva" = "Boliva",
                       "Bosnia and Herzegovina" = "Bosnia and Herzegovina",
                       "Botswana" = "Botswana",
                       "Brazil" = "Brazil",
                       "Bulgaria" = "Bulgaria",
                       "Burkina Faso" = "Burkina Faso",
                       "Burundi" = "Burundi",
                       "Cambodia" = "Cambodia",
                       "Cameroon" = "Cameroon",
                       "Canada" = "Canada",
                       "Cape Verde" = "Cape Verde",
                       "Central African Republic" = "Central African Republic",
                       "Chad" = "Chad",
                       "Chile" = "Chile",
                       "China" = "China",
                       "Colombia" = "Colombia",
                       "Comoros" = "Comoros",
                       "Congo, Democratic Republic of" = "Congo, Democratic Republic of",
                       "Congo, Republic of" = "Congo, Republic of",
                       "Costa Rica" = "Costa Rica",
                       "Cote d'Ivoire" = "Cote d'Ivoire",
                       "Croatia" = "Croatia",
                       "Cuba" = "Cuba",
                       "Cyprus" = "Cyprus",
                       "Czech Republic" = "Czech Republic",
                       "Czechoslovakia" = "Czechoslovakia",
                       "Denmark" = "Denmark",
                       "Djibouti" = "Djibouti",
                       "Dominica" = "Dominica",
                       "Dominican Republic" = "Dominican Republic",
                       "Ecuador" = "Ecuador",
                       "Egypt" = "Egypt",
                       "El Salvador" = "El Salvador",
                       "Estonia" = "Estonia",
                       "Ethiopia" = "Ethiopia",
                       "Fiji" = "Fiji",
                       "Finland" = "Finland",
                       "France" = "France",
                       "Gabon" = "Gabon",
                       "Gambia" = "Gambia",
                       "Georgia" = "Georgia",
                       "Germany" = "Germany",
                       "Ghana" = "Ghana",
                       "Greece" = "Greece",
                       "Grenada" = "Grenada",
                       "Guatemala" = "Guatemala",
                       "Guinea" = "Guinea",
                       "Guinea-Bissau" = "Guinea-Bissau",
                       "Guyana" = "Guyana",
                       "Haiti" = "Haiti",
                       "Honduras" = "Honduras",
                       "Hong Kong" = "Hong Kong",
                       "Hungary" = "Hungary",
                       "Iceland" = "Iceland",
                       "India" = "India",
                       "Indonesia" = "Indonesia",
                       "Iran" = "Iran",
                       "Iraq" = "Iraq",
                       "Ireland" = "Ireland",
                       "Israel" = "Israel",
                       "Italy" = "Italy",
                       "Jamaica" = "Jamaica",
                       "Japan" = "Japan",
                       "Jordan" = "Jordan",
                       "Kazakhstan" = "Kazakhstan",
                       "Kenya" = "Kenya",
                       "Korea, Republic of" = "Korea, Republic of",
                       "Kyrgyz Republic" = "Kyrgyz Republic",
                       "Lao" = "Lao",
                       "Latvia" = "Latvia",
                       "Lebanon" = "Lebanon",
                       "Lesotho" = "Lesotho",
                       "Liberia" = "Liberia",
                       "Lithuania" = "Lithuania",
                       "Luxembourg" = "Luxembourg",
                       "Macedonia, FYR" = "Macedonia, FYR",
                       "Madagascar" = "Madagascar",
                       "Malawi" = "Malawi",
                       "Malaysia" = "Malaysia",
                       "Maldives" = "Maldives",
                       "Mali" = "Mali",
                       "Malta" = "Malta",
                       "Mauritania" = "Mauritania",
                       "Mauritius" = "Mauritius",
                       "Mexico" = "Mexico",
                       "Moldova" = "Moldova",
                       "Mongolia" = "Mongolia",
                       "Montenegro" = "Montenegro",
                       "Morocco" = "Morocco",
                       "Mozambique" = "Mozambique",
                       "Namibia" = "Namibia",
                       "Nepal" = "Nepal",
                       "Netherlands" = "Netherlands",
                       "New Zealand" = "New Zealand",
                       "Nicaragua" = "Nicaragua",
                       "Niger" = "Niger",
                       "Nigeria" = "Nigeria",
                       "Norway" = "Norway",
                       "Pakistan" = "Pakistan",
                       "Panama" = "Panama",
                       "Papua New Guinea" = "Papua New Guinea",
                       "Paraguay" = "Paraguay",
                       "Peru" = "Peru",
                       "Philippines" = "Philippines",
                       "Poland" = "Poland",
                       "Portugal" = "Portugal",
                       "Puerto Rico" = "Puerto Rico",
                       "Reunion" = "Reunion",
                       "Romania" = "Romania",
                       "Russian Federation" = "Russian Federation",
                       "Rwanda" = "Rwanda",
                       "Sao Tome and Principe" = "Sao Tome and Principe",
                       "Senegal" = "Senegal",
                       "Serbia" = "Serbia",
                       "Serbia and Montenegro" = "Serbia and Montenegro",
                       "Seychelles" = "Seychelles",
                       "Sierra Leone" = "Sierra Leone",
                       "Singapore" = "Singapore",
                       "Slovak Republic" = "Slovak Republic",
                       "Slovenia" = "Slovenia",
                       "Somalia" = "Somalia",
                       "South Africa" = "South Africa",
                       "Spain" = "Spain",
                       "Sri Lanka" = "Sri Lanka",
                       "St. Lucia" = "St. Lucia",
                       "St. Vincent and the Grenadines" = "St. Vincent and the Grenadines",
                       "Sudan" = "Sudan",
                       "Suriname" = "Suriname",
                       "Swaziland" = "Swaziland",
                       "Sweden" = "Sweden",
                       "Switzerland" = "Switzerland",
                       "Syria" = "Syria",
                       "Taiwan" = "Taiwan",
                       "Tajikistan" = "Tajikistan",
                       "Tanzania" = "Tanzania",
                       "Thailand" = "Thailand",
                       "Timor-Leste" = "Timor-Leste",
                       "Togo" = "Togo",
                       "Trinidad and Tobago" = "Trinidad and Tobago",
                       "Tunisia" = "Tunisia",
                       "Turkey" = "Turkey",
                       "Turkmenistan" = "Turkmenistan",
                       "Turks and Caicos" = "Turks and Caicos",
                       "USSR" = "USSR",
                       "Uganda" = "Uganda",
                       "Ukraine" = "Ukraine",
                       "United Kingdom" = "United Kingdom",
                       "United States" = "United States",
                       "Uruguay" = "Uruguay",
                       "Uzbekistan" = "Uzbekistan",
                       "Venezuela" = "Venezuela",
                       "Viet Nam" = "Viet Nam",
                       "Yemen, Republic of" = "Yemen, Republic of",
                       "Yugoslavia" = "Yugoslavia",
                       "Zambia" = "Zambia",
                       "Zimbabwe" = "Zimbabwe")
    
    series <- switch(input$series,
                     "gini_net" = "gini_net",
                     "gini_market" = "gini_market")
    
    if(input$country1=="Not Selected"){
      data.1 <- data.frame(swiid[swiid$country=="Not Selected",])
    } else{
      data.1 <- data.frame(swiid[swiid$country==input$country1,])
    }
    
    
    if(input$country2=="Not Selected"){
      data.2 <- data.frame(swiid[swiid$country=="Not Selected",])
    } else{
      data.2 <- data.frame(swiid[swiid$country==input$country2,])
    }
    
    
    if(input$country3=="Not Selected"){
      data.3 <- data.frame(swiid[swiid$country=="Not Selected",])
    } else{
      data.3 <- data.frame(swiid[swiid$country==input$country3,])
    }
    
    
    if(input$country4=="Not Selected"){
      data.4 <- data.frame(swiid[swiid$country=="Not Selected",])
    } else{
      data.4 <- data.frame(swiid[swiid$country==input$country4,])
    }
    
    data.5 <- rbind(data.1,data.2)
    data.6 <- rbind(data.3,data.4)
    total <- rbind(data.5,data.6)
    
    
    if(input$series == "gini_net"){
    print(
      ggplot(total, aes(x=year, y=gini_net, colour=country)) + 
        geom_line() +
        geom_ribbon(aes(ymin = gini_net-1.96*gini_net_se, ymax = gini_net+1.96*gini_net_se, 
                                    fill=country, linetype=NA), alpha = .25) +
        coord_cartesian(xlim=c(input$dates[1],input$dates[2])) +
        labs(x = "Year", y = "SWIID Gini Index, Net Income")
      )
    }
    else{
      print(
        ggplot(total, aes(x=year, y=gini_market, colour=country)) + 
          geom_line() +
          geom_ribbon(aes(ymin = gini_market-1.96*gini_market_se, ymax = gini_market+1.96*gini_market_se, 
                          fill=country, linetype=NA), alpha = .25) +
          coord_cartesian(xlim=c(input$dates[1],input$dates[2])) +
          labs(x = "Year", y = "SWIID Gini Index, Market Income")
        )
    }
    
  })
    
}
)